{"code":"(()=>{\n\"use strict\";var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});Object.defineProperty(exports,\"__esModule\",{value:true});exports.getFeed=void 0;var stringify_js_1=require(\"./stringify.js\");var legacy_js_1=require(\"./legacy.js\");function getFeed(doc){var feedRoot=getOneElement(isValidFeed,doc);return!feedRoot?null:feedRoot.name===\"feed\"?getAtomFeed(feedRoot):getRssFeed(feedRoot)}__name(getFeed,\"getFeed\");exports.getFeed=getFeed;function getAtomFeed(feedRoot){var _a;var childs=feedRoot.children;var feed={type:\"atom\",items:(0,legacy_js_1.getElementsByTagName)(\"entry\",childs).map(function(item){var _a2;var children=item.children;var entry={media:getMediaElements(children)};addConditionally(entry,\"id\",\"id\",children);addConditionally(entry,\"title\",\"title\",children);var href2=(_a2=getOneElement(\"link\",children))===null||_a2===void 0?void 0:_a2.attribs[\"href\"];if(href2){entry.link=href2}var description=fetch(\"summary\",children)||fetch(\"content\",children);if(description){entry.description=description}var pubDate=fetch(\"updated\",children);if(pubDate){entry.pubDate=new Date(pubDate)}return entry})};addConditionally(feed,\"id\",\"id\",childs);addConditionally(feed,\"title\",\"title\",childs);var href=(_a=getOneElement(\"link\",childs))===null||_a===void 0?void 0:_a.attribs[\"href\"];if(href){feed.link=href}addConditionally(feed,\"description\",\"subtitle\",childs);var updated=fetch(\"updated\",childs);if(updated){feed.updated=new Date(updated)}addConditionally(feed,\"author\",\"email\",childs,true);return feed}__name(getAtomFeed,\"getAtomFeed\");function getRssFeed(feedRoot){var _a,_b;var childs=(_b=(_a=getOneElement(\"channel\",feedRoot.children))===null||_a===void 0?void 0:_a.children)!==null&&_b!==void 0?_b:[];var feed={type:feedRoot.name.substr(0,3),id:\"\",items:(0,legacy_js_1.getElementsByTagName)(\"item\",feedRoot.children).map(function(item){var children=item.children;var entry={media:getMediaElements(children)};addConditionally(entry,\"id\",\"guid\",children);addConditionally(entry,\"title\",\"title\",children);addConditionally(entry,\"link\",\"link\",children);addConditionally(entry,\"description\",\"description\",children);var pubDate=fetch(\"pubDate\",children)||fetch(\"dc:date\",children);if(pubDate)entry.pubDate=new Date(pubDate);return entry})};addConditionally(feed,\"title\",\"title\",childs);addConditionally(feed,\"link\",\"link\",childs);addConditionally(feed,\"description\",\"description\",childs);var updated=fetch(\"lastBuildDate\",childs);if(updated){feed.updated=new Date(updated)}addConditionally(feed,\"author\",\"managingEditor\",childs,true);return feed}__name(getRssFeed,\"getRssFeed\");var MEDIA_KEYS_STRING=[\"url\",\"type\",\"lang\"];var MEDIA_KEYS_INT=[\"fileSize\",\"bitrate\",\"framerate\",\"samplingrate\",\"channels\",\"duration\",\"height\",\"width\"];function getMediaElements(where){return(0,legacy_js_1.getElementsByTagName)(\"media:content\",where).map(function(elem){var attribs=elem.attribs;var media={medium:attribs[\"medium\"],isDefault:!!attribs[\"isDefault\"]};for(var _i=0,MEDIA_KEYS_STRING_1=MEDIA_KEYS_STRING;_i<MEDIA_KEYS_STRING_1.length;_i++){var attrib=MEDIA_KEYS_STRING_1[_i];if(attribs[attrib]){media[attrib]=attribs[attrib]}}for(var _a=0,MEDIA_KEYS_INT_1=MEDIA_KEYS_INT;_a<MEDIA_KEYS_INT_1.length;_a++){var attrib=MEDIA_KEYS_INT_1[_a];if(attribs[attrib]){media[attrib]=parseInt(attribs[attrib],10)}}if(attribs[\"expression\"]){media.expression=attribs[\"expression\"]}return media})}__name(getMediaElements,\"getMediaElements\");function getOneElement(tagName,node){return(0,legacy_js_1.getElementsByTagName)(tagName,node,true,1)[0]}__name(getOneElement,\"getOneElement\");function fetch(tagName,where,recurse){if(recurse===void 0){recurse=false}return(0,stringify_js_1.textContent)((0,legacy_js_1.getElementsByTagName)(tagName,where,recurse,1)).trim()}__name(fetch,\"fetch\");function addConditionally(obj,prop,tagName,where,recurse){if(recurse===void 0){recurse=false}var val=fetch(tagName,where,recurse);if(val)obj[prop]=val}__name(addConditionally,\"addConditionally\");function isValidFeed(value){return value===\"rss\"||value===\"feed\"||value===\"rdf:RDF\"}__name(isValidFeed,\"isValidFeed\");\n})()\n","warnings":[],"map":{"version":3,"mappings":";+HACA,OAAO,eAAe,QAAS,aAAc,CAAE,MAAO,IAAK,CAAC,EAC5D,QAAQ,QAAU,OAClB,IAAI,eAAiB,QAAQ,gBAAgB,EAC7C,IAAI,YAAc,QAAQ,aAAa,EAQvC,SAAS,QAAQ,IAAK,CAClB,IAAI,SAAW,cAAc,YAAa,GAAG,EAC7C,MAAO,CAAC,SACF,KACA,SAAS,OAAS,OACd,YAAY,QAAQ,EACpB,WAAW,QAAQ,CACjC,CAPS,0BAQT,QAAQ,QAAU,QAOlB,SAAS,YAAY,SAAU,CAC3B,IAAI,GACJ,IAAI,OAAS,SAAS,SACtB,IAAI,KAAO,CACP,KAAM,OACN,OAAQ,EAAG,YAAY,sBAAsB,QAAS,MAAM,EAAE,IAAI,SAAU,KAAM,CAC9E,IAAIA,IACJ,IAAI,SAAW,KAAK,SACpB,IAAI,MAAQ,CAAE,MAAO,iBAAiB,QAAQ,CAAE,EAChD,iBAAiB,MAAO,KAAM,KAAM,QAAQ,EAC5C,iBAAiB,MAAO,QAAS,QAAS,QAAQ,EAClD,IAAIC,OAAQD,IAAK,cAAc,OAAQ,QAAQ,KAAO,MAAQA,MAAO,OAAS,OAASA,IAAG,QAAQ,MAAM,EACxG,GAAIC,MAAM,CACN,MAAM,KAAOA,KACjB,CACA,IAAI,YAAc,MAAM,UAAW,QAAQ,GAAK,MAAM,UAAW,QAAQ,EACzE,GAAI,YAAa,CACb,MAAM,YAAc,WACxB,CACA,IAAI,QAAU,MAAM,UAAW,QAAQ,EACvC,GAAI,QAAS,CACT,MAAM,QAAU,IAAI,KAAK,OAAO,CACpC,CACA,OAAO,KACX,CAAC,CACL,EACA,iBAAiB,KAAM,KAAM,KAAM,MAAM,EACzC,iBAAiB,KAAM,QAAS,QAAS,MAAM,EAC/C,IAAI,MAAQ,GAAK,cAAc,OAAQ,MAAM,KAAO,MAAQ,KAAO,OAAS,OAAS,GAAG,QAAQ,MAAM,EACtG,GAAI,KAAM,CACN,KAAK,KAAO,IAChB,CACA,iBAAiB,KAAM,cAAe,WAAY,MAAM,EACxD,IAAI,QAAU,MAAM,UAAW,MAAM,EACrC,GAAI,QAAS,CACT,KAAK,QAAU,IAAI,KAAK,OAAO,CACnC,CACA,iBAAiB,KAAM,SAAU,QAAS,OAAQ,IAAI,EACtD,OAAO,IACX,CAvCS,kCA8CT,SAAS,WAAW,SAAU,CAC1B,IAAI,GAAI,GACR,IAAI,QAAU,IAAM,GAAK,cAAc,UAAW,SAAS,QAAQ,KAAO,MAAQ,KAAO,OAAS,OAAS,GAAG,YAAc,MAAQ,KAAO,OAAS,GAAK,CAAC,EAC1J,IAAI,KAAO,CACP,KAAM,SAAS,KAAK,OAAO,EAAG,CAAC,EAC/B,GAAI,GACJ,OAAQ,EAAG,YAAY,sBAAsB,OAAQ,SAAS,QAAQ,EAAE,IAAI,SAAU,KAAM,CACxF,IAAI,SAAW,KAAK,SACpB,IAAI,MAAQ,CAAE,MAAO,iBAAiB,QAAQ,CAAE,EAChD,iBAAiB,MAAO,KAAM,OAAQ,QAAQ,EAC9C,iBAAiB,MAAO,QAAS,QAAS,QAAQ,EAClD,iBAAiB,MAAO,OAAQ,OAAQ,QAAQ,EAChD,iBAAiB,MAAO,cAAe,cAAe,QAAQ,EAC9D,IAAI,QAAU,MAAM,UAAW,QAAQ,GAAK,MAAM,UAAW,QAAQ,EACrE,GAAI,QACA,MAAM,QAAU,IAAI,KAAK,OAAO,EACpC,OAAO,KACX,CAAC,CACL,EACA,iBAAiB,KAAM,QAAS,QAAS,MAAM,EAC/C,iBAAiB,KAAM,OAAQ,OAAQ,MAAM,EAC7C,iBAAiB,KAAM,cAAe,cAAe,MAAM,EAC3D,IAAI,QAAU,MAAM,gBAAiB,MAAM,EAC3C,GAAI,QAAS,CACT,KAAK,QAAU,IAAI,KAAK,OAAO,CACnC,CACA,iBAAiB,KAAM,SAAU,iBAAkB,OAAQ,IAAI,EAC/D,OAAO,IACX,CA5BS,gCA6BT,IAAI,kBAAoB,CAAC,MAAO,OAAQ,MAAM,EAC9C,IAAI,eAAiB,CACjB,WACA,UACA,YACA,eACA,WACA,WACA,SACA,OACJ,EAOA,SAAS,iBAAiB,MAAO,CAC7B,OAAQ,EAAG,YAAY,sBAAsB,gBAAiB,KAAK,EAAE,IAAI,SAAU,KAAM,CACrF,IAAI,QAAU,KAAK,QACnB,IAAI,MAAQ,CACR,OAAQ,QAAQ,QAAQ,EACxB,UAAW,CAAC,CAAC,QAAQ,WAAW,CACpC,EACA,QAAS,GAAK,EAAG,oBAAsB,kBAAmB,GAAK,oBAAoB,OAAQ,KAAM,CAC7F,IAAI,OAAS,oBAAoB,EAAE,EACnC,GAAI,QAAQ,MAAM,EAAG,CACjB,MAAM,MAAM,EAAI,QAAQ,MAAM,CAClC,CACJ,CACA,QAAS,GAAK,EAAG,iBAAmB,eAAgB,GAAK,iBAAiB,OAAQ,KAAM,CACpF,IAAI,OAAS,iBAAiB,EAAE,EAChC,GAAI,QAAQ,MAAM,EAAG,CACjB,MAAM,MAAM,EAAI,SAAS,QAAQ,MAAM,EAAG,EAAE,CAChD,CACJ,CACA,GAAI,QAAQ,YAAY,EAAG,CACvB,MAAM,WAAa,QAAQ,YAAY,CAC3C,CACA,OAAO,KACX,CAAC,CACL,CAxBS,4CAgCT,SAAS,cAAc,QAAS,KAAM,CAClC,OAAQ,EAAG,YAAY,sBAAsB,QAAS,KAAM,KAAM,CAAC,EAAE,CAAC,CAC1E,CAFS,sCAWT,SAAS,MAAM,QAAS,MAAO,QAAS,CACpC,GAAI,UAAY,OAAQ,CAAE,QAAU,KAAO,CAC3C,OAAQ,EAAG,eAAe,cAAc,EAAG,YAAY,sBAAsB,QAAS,MAAO,QAAS,CAAC,CAAC,EAAE,KAAK,CACnH,CAHS,sBAaT,SAAS,iBAAiB,IAAK,KAAM,QAAS,MAAO,QAAS,CAC1D,GAAI,UAAY,OAAQ,CAAE,QAAU,KAAO,CAC3C,IAAI,IAAM,MAAM,QAAS,MAAO,OAAO,EACvC,GAAI,IACA,IAAI,IAAI,EAAI,GACpB,CALS,4CAYT,SAAS,YAAY,MAAO,CACxB,OAAO,QAAU,OAAS,QAAU,QAAU,QAAU,SAC5D,CAFS","names":["_a","href"],"sources":["/Users/markbakker/RiderProjects/mycrm/node_modules/.pnpm/domutils@3.1.0/node_modules/domutils/lib/feeds.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getFeed = void 0;\nvar stringify_js_1 = require(\"./stringify.js\");\nvar legacy_js_1 = require(\"./legacy.js\");\n/**\n * Get the feed object from the root of a DOM tree.\n *\n * @category Feeds\n * @param doc - The DOM to to extract the feed from.\n * @returns The feed.\n */\nfunction getFeed(doc) {\n    var feedRoot = getOneElement(isValidFeed, doc);\n    return !feedRoot\n        ? null\n        : feedRoot.name === \"feed\"\n            ? getAtomFeed(feedRoot)\n            : getRssFeed(feedRoot);\n}\nexports.getFeed = getFeed;\n/**\n * Parse an Atom feed.\n *\n * @param feedRoot The root of the feed.\n * @returns The parsed feed.\n */\nfunction getAtomFeed(feedRoot) {\n    var _a;\n    var childs = feedRoot.children;\n    var feed = {\n        type: \"atom\",\n        items: (0, legacy_js_1.getElementsByTagName)(\"entry\", childs).map(function (item) {\n            var _a;\n            var children = item.children;\n            var entry = { media: getMediaElements(children) };\n            addConditionally(entry, \"id\", \"id\", children);\n            addConditionally(entry, \"title\", \"title\", children);\n            var href = (_a = getOneElement(\"link\", children)) === null || _a === void 0 ? void 0 : _a.attribs[\"href\"];\n            if (href) {\n                entry.link = href;\n            }\n            var description = fetch(\"summary\", children) || fetch(\"content\", children);\n            if (description) {\n                entry.description = description;\n            }\n            var pubDate = fetch(\"updated\", children);\n            if (pubDate) {\n                entry.pubDate = new Date(pubDate);\n            }\n            return entry;\n        }),\n    };\n    addConditionally(feed, \"id\", \"id\", childs);\n    addConditionally(feed, \"title\", \"title\", childs);\n    var href = (_a = getOneElement(\"link\", childs)) === null || _a === void 0 ? void 0 : _a.attribs[\"href\"];\n    if (href) {\n        feed.link = href;\n    }\n    addConditionally(feed, \"description\", \"subtitle\", childs);\n    var updated = fetch(\"updated\", childs);\n    if (updated) {\n        feed.updated = new Date(updated);\n    }\n    addConditionally(feed, \"author\", \"email\", childs, true);\n    return feed;\n}\n/**\n * Parse a RSS feed.\n *\n * @param feedRoot The root of the feed.\n * @returns The parsed feed.\n */\nfunction getRssFeed(feedRoot) {\n    var _a, _b;\n    var childs = (_b = (_a = getOneElement(\"channel\", feedRoot.children)) === null || _a === void 0 ? void 0 : _a.children) !== null && _b !== void 0 ? _b : [];\n    var feed = {\n        type: feedRoot.name.substr(0, 3),\n        id: \"\",\n        items: (0, legacy_js_1.getElementsByTagName)(\"item\", feedRoot.children).map(function (item) {\n            var children = item.children;\n            var entry = { media: getMediaElements(children) };\n            addConditionally(entry, \"id\", \"guid\", children);\n            addConditionally(entry, \"title\", \"title\", children);\n            addConditionally(entry, \"link\", \"link\", children);\n            addConditionally(entry, \"description\", \"description\", children);\n            var pubDate = fetch(\"pubDate\", children) || fetch(\"dc:date\", children);\n            if (pubDate)\n                entry.pubDate = new Date(pubDate);\n            return entry;\n        }),\n    };\n    addConditionally(feed, \"title\", \"title\", childs);\n    addConditionally(feed, \"link\", \"link\", childs);\n    addConditionally(feed, \"description\", \"description\", childs);\n    var updated = fetch(\"lastBuildDate\", childs);\n    if (updated) {\n        feed.updated = new Date(updated);\n    }\n    addConditionally(feed, \"author\", \"managingEditor\", childs, true);\n    return feed;\n}\nvar MEDIA_KEYS_STRING = [\"url\", \"type\", \"lang\"];\nvar MEDIA_KEYS_INT = [\n    \"fileSize\",\n    \"bitrate\",\n    \"framerate\",\n    \"samplingrate\",\n    \"channels\",\n    \"duration\",\n    \"height\",\n    \"width\",\n];\n/**\n * Get all media elements of a feed item.\n *\n * @param where Nodes to search in.\n * @returns Media elements.\n */\nfunction getMediaElements(where) {\n    return (0, legacy_js_1.getElementsByTagName)(\"media:content\", where).map(function (elem) {\n        var attribs = elem.attribs;\n        var media = {\n            medium: attribs[\"medium\"],\n            isDefault: !!attribs[\"isDefault\"],\n        };\n        for (var _i = 0, MEDIA_KEYS_STRING_1 = MEDIA_KEYS_STRING; _i < MEDIA_KEYS_STRING_1.length; _i++) {\n            var attrib = MEDIA_KEYS_STRING_1[_i];\n            if (attribs[attrib]) {\n                media[attrib] = attribs[attrib];\n            }\n        }\n        for (var _a = 0, MEDIA_KEYS_INT_1 = MEDIA_KEYS_INT; _a < MEDIA_KEYS_INT_1.length; _a++) {\n            var attrib = MEDIA_KEYS_INT_1[_a];\n            if (attribs[attrib]) {\n                media[attrib] = parseInt(attribs[attrib], 10);\n            }\n        }\n        if (attribs[\"expression\"]) {\n            media.expression = attribs[\"expression\"];\n        }\n        return media;\n    });\n}\n/**\n * Get one element by tag name.\n *\n * @param tagName Tag name to look for\n * @param node Node to search in\n * @returns The element or null\n */\nfunction getOneElement(tagName, node) {\n    return (0, legacy_js_1.getElementsByTagName)(tagName, node, true, 1)[0];\n}\n/**\n * Get the text content of an element with a certain tag name.\n *\n * @param tagName Tag name to look for.\n * @param where Node to search in.\n * @param recurse Whether to recurse into child nodes.\n * @returns The text content of the element.\n */\nfunction fetch(tagName, where, recurse) {\n    if (recurse === void 0) { recurse = false; }\n    return (0, stringify_js_1.textContent)((0, legacy_js_1.getElementsByTagName)(tagName, where, recurse, 1)).trim();\n}\n/**\n * Adds a property to an object if it has a value.\n *\n * @param obj Object to be extended\n * @param prop Property name\n * @param tagName Tag name that contains the conditionally added property\n * @param where Element to search for the property\n * @param recurse Whether to recurse into child nodes.\n */\nfunction addConditionally(obj, prop, tagName, where, recurse) {\n    if (recurse === void 0) { recurse = false; }\n    var val = fetch(tagName, where, recurse);\n    if (val)\n        obj[prop] = val;\n}\n/**\n * Checks if an element is a feed root node.\n *\n * @param value The name of the element to check.\n * @returns Whether an element is a feed root node.\n */\nfunction isValidFeed(value) {\n    return value === \"rss\" || value === \"feed\" || value === \"rdf:RDF\";\n}\n//# sourceMappingURL=feeds.js.map"]}}